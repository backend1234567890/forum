{"C:\\FAIZ\\UNIV\\Gabut v2.0\\forum\\src\\server.ts":{"path":"C:\\FAIZ\\UNIV\\Gabut v2.0\\forum\\src\\server.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"25":{"start":{"line":26,"column":4},"end":{"line":26,"column":62}},"26":{"start":{"line":28,"column":0},"end":{"line":28,"column":62}},"27":{"start":{"line":29,"column":18},"end":{"line":29,"column":50}},"28":{"start":{"line":30,"column":15},"end":{"line":30,"column":47}},"29":{"start":{"line":31,"column":17},"end":{"line":31,"column":51}},"30":{"start":{"line":32,"column":22},"end":{"line":32,"column":63}},"31":{"start":{"line":33,"column":33},"end":{"line":33,"column":83}},"32":{"start":{"line":34,"column":15},"end":{"line":34,"column":47}},"33":{"start":{"line":35,"column":29},"end":{"line":35,"column":75}},"34":{"start":{"line":36,"column":13},"end":{"line":36,"column":43}},"35":{"start":{"line":37,"column":15},"end":{"line":37,"column":47}},"36":{"start":{"line":38,"column":18},"end":{"line":38,"column":53}},"37":{"start":{"line":39,"column":16},"end":{"line":39,"column":34}},"38":{"start":{"line":40,"column":15},"end":{"line":40,"column":32}},"39":{"start":{"line":41,"column":13},"end":{"line":41,"column":79}},"40":{"start":{"line":42,"column":13},"end":{"line":42,"column":52}},"41":{"start":{"line":43,"column":12},"end":{"line":43,"column":36}},"42":{"start":{"line":45,"column":0},"end":{"line":45,"column":31}},"43":{"start":{"line":47,"column":0},"end":{"line":47,"column":31}},"44":{"start":{"line":49,"column":0},"end":{"line":49,"column":38}},"45":{"start":{"line":51,"column":13},"end":{"line":51,"column":108}},"46":{"start":{"line":52,"column":0},"end":{"line":52,"column":50}},"47":{"start":{"line":52,"column":27},"end":{"line":52,"column":48}},"48":{"start":{"line":58,"column":0},"end":{"line":61,"column":3}},"49":{"start":{"line":59,"column":21},"end":{"line":59,"column":41}},"50":{"start":{"line":60,"column":4},"end":{"line":60,"column":23}},"51":{"start":{"line":62,"column":0},"end":{"line":66,"column":3}},"52":{"start":{"line":63,"column":64},"end":{"line":63,"column":72}},"53":{"start":{"line":64,"column":21},"end":{"line":64,"column":98}},"54":{"start":{"line":65,"column":4},"end":{"line":65,"column":23}},"55":{"start":{"line":67,"column":0},"end":{"line":71,"column":3}},"56":{"start":{"line":68,"column":35},"end":{"line":68,"column":43}},"57":{"start":{"line":69,"column":21},"end":{"line":69,"column":66}},"58":{"start":{"line":70,"column":4},"end":{"line":70,"column":23}},"59":{"start":{"line":72,"column":0},"end":{"line":76,"column":3}},"60":{"start":{"line":73,"column":18},"end":{"line":73,"column":35}},"61":{"start":{"line":74,"column":21},"end":{"line":74,"column":54}},"62":{"start":{"line":75,"column":4},"end":{"line":75,"column":23}},"63":{"start":{"line":86,"column":0},"end":{"line":99,"column":3}},"64":{"start":{"line":87,"column":18},"end":{"line":97,"column":5}},"65":{"start":{"line":98,"column":4},"end":{"line":98,"column":36}},"66":{"start":{"line":101,"column":0},"end":{"line":101,"column":49}},"67":{"start":{"line":103,"column":15},"end":{"line":106,"column":2}},"68":{"start":{"line":105,"column":4},"end":{"line":105,"column":64}},"69":{"start":{"line":108,"column":0},"end":{"line":110,"column":3}},"70":{"start":{"line":109,"column":4},"end":{"line":109,"column":72}},"71":{"start":{"line":109,"column":23},"end":{"line":109,"column":70}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":56},"end":{"line":25,"column":57}},"loc":{"start":{"line":25,"column":71},"end":{"line":27,"column":1}},"line":25},"7":{"name":"(anonymous_7)","decl":{"start":{"line":52,"column":13},"end":{"line":52,"column":14}},"loc":{"start":{"line":52,"column":27},"end":{"line":52,"column":48}},"line":52},"8":{"name":"(anonymous_8)","decl":{"start":{"line":58,"column":21},"end":{"line":58,"column":22}},"loc":{"start":{"line":58,"column":35},"end":{"line":61,"column":1}},"line":58},"9":{"name":"(anonymous_9)","decl":{"start":{"line":62,"column":32},"end":{"line":62,"column":33}},"loc":{"start":{"line":62,"column":46},"end":{"line":66,"column":1}},"line":62},"10":{"name":"(anonymous_10)","decl":{"start":{"line":67,"column":29},"end":{"line":67,"column":30}},"loc":{"start":{"line":67,"column":43},"end":{"line":71,"column":1}},"line":67},"11":{"name":"(anonymous_11)","decl":{"start":{"line":72,"column":30},"end":{"line":72,"column":31}},"loc":{"start":{"line":72,"column":44},"end":{"line":76,"column":1}},"line":72},"12":{"name":"(anonymous_12)","decl":{"start":{"line":86,"column":8},"end":{"line":86,"column":9}},"loc":{"start":{"line":86,"column":22},"end":{"line":99,"column":1}},"line":86},"13":{"name":"(anonymous_13)","decl":{"start":{"line":103,"column":38},"end":{"line":103,"column":39}},"loc":{"start":{"line":103,"column":44},"end":{"line":106,"column":1}},"line":103},"14":{"name":"(anonymous_14)","decl":{"start":{"line":108,"column":31},"end":{"line":108,"column":32}},"loc":{"start":{"line":108,"column":37},"end":{"line":110,"column":1}},"line":108},"15":{"name":"(anonymous_15)","decl":{"start":{"line":109,"column":17},"end":{"line":109,"column":18}},"loc":{"start":{"line":109,"column":23},"end":{"line":109,"column":70}},"line":109}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":27}},{"start":{"line":25,"column":31},"end":{"line":25,"column":51}},{"start":{"line":25,"column":56},"end":{"line":27,"column":1}}],"line":25},"17":{"loc":{"start":{"line":26,"column":11},"end":{"line":26,"column":61}},"type":"cond-expr","locations":[{"start":{"line":26,"column":37},"end":{"line":26,"column":40}},{"start":{"line":26,"column":43},"end":{"line":26,"column":61}}],"line":26},"18":{"loc":{"start":{"line":26,"column":12},"end":{"line":26,"column":33}},"type":"binary-expr","locations":[{"start":{"line":26,"column":12},"end":{"line":26,"column":15}},{"start":{"line":26,"column":19},"end":{"line":26,"column":33}}],"line":26},"19":{"loc":{"start":{"line":41,"column":22},"end":{"line":41,"column":78}},"type":"binary-expr","locations":[{"start":{"line":41,"column":22},"end":{"line":41,"column":48}},{"start":{"line":41,"column":52},"end":{"line":41,"column":78}}],"line":41},"20":{"loc":{"start":{"line":42,"column":13},"end":{"line":42,"column":52}},"type":"binary-expr","locations":[{"start":{"line":42,"column":13},"end":{"line":42,"column":37}},{"start":{"line":42,"column":41},"end":{"line":42,"column":52}}],"line":42}},"s":{"0":1,"1":11,"2":11,"3":11,"4":11,"5":11,"6":1,"7":11,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":1,"15":1,"16":0,"17":1,"18":1,"19":1,"20":11,"21":11,"22":1,"23":1,"24":1,"25":9,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":0,"48":1,"49":16,"50":16,"51":1,"52":25,"53":25,"54":16,"55":1,"56":7,"57":7,"58":4,"59":1,"60":6,"61":6,"62":5,"63":1,"64":0,"65":0,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1},"f":{"0":11,"1":1,"2":0,"3":1,"4":0,"5":1,"6":9,"7":0,"8":16,"9":25,"10":7,"11":6,"12":0,"13":1,"14":1,"15":1},"b":{"0":[1,1,1],"1":[1,0],"2":[11,0],"3":[11,0],"4":[11,11],"5":[0,11],"6":[11,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,1],"13":[1,0],"14":[11,0],"15":[11,11],"16":[1,1,1],"17":[0,9],"18":[9,9],"19":[1,1],"20":[1,1]},"inputSourceMap":{"version":3,"file":"C:/FAIZ/UNIV/Gabut v2.0/forum/src/server.ts","sources":["C:/FAIZ/UNIV/Gabut v2.0/forum/src/server.ts"],"names":[],"mappings":"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","sourcesContent":["import express, { json, Request, Response } from 'express';\r\nimport cors from 'cors';\r\nimport morgan from 'morgan';\r\nimport config from './config.json';\r\nimport errorHandler from 'middleware-http-errors';\r\nimport YAML from 'yaml';\r\nimport sui from 'swagger-ui-express';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport process from 'process';\r\n\r\nimport { clear } from './other';\r\nimport { \r\n  userAuthRegister,\r\n  userAuthLogin,\r\n  userAuthLogout\r\n} from './auth';\r\n\r\nconst PORT: number = parseInt(process.env.PORT || config.port);\r\nconst HOST: string = process.env.IP || '127.0.0.1';\r\n\r\nconst app = express();\r\n\r\n// Use middleware that allows for access from other domains (needed for frontend to connect)\r\napp.use(cors());\r\n// Use middleware that allows us to access the JSON body of requests\r\napp.use(json());\r\n// Use middleware to log (print to terminal) incoming HTTP requests (OPTIONAL)\r\napp.use(morgan('dev'));\r\n\r\n\r\n// for producing the docs that define the API\r\nconst file = fs.readFileSync(path.join(process.cwd(), 'swagger.yaml'), 'utf8');\r\napp.get('/', (req: Request, res: Response) => res.redirect('/docs'));\r\n// istanbul ignore next\r\napp.use('/docs', sui.serve, sui.setup(YAML.parse(file), { swaggerOptions: { docExpansion: false ? 'full' : 'list' } }));\r\n\r\n// ========================================================================= //\r\n// YOUR ROUTES SHOULD BE DEFINED BELOW THIS DIVIDER\r\n// ========================================================================= //\r\n\r\napp.delete('/clear', (req: Request, res: Response) => {\r\n    const response = clear();\r\n  \r\n    res.json(response);\r\n});\r\n\r\napp.post('/user/auth/register', (req: Request, res: Response) => {\r\n  const { username, displayName, password, repeatPassword } = req.body;\r\n  const response = userAuthRegister(username, displayName, password, repeatPassword);\r\n\r\n  res.json(response);\r\n});\r\n\r\napp.post('/user/auth/login', (req: Request, res: Response) => {\r\n  const { username, password } = req.body;\r\n  const response = userAuthLogin(username, password);\r\n\r\n  res.json(response);\r\n});\r\n\r\napp.post('/user/auth/logout', (req: Request, res: Response) => {\r\n  const token = req.headers.token as string;\r\n  const response = userAuthLogout(token);\r\n\r\n  res.json(response);\r\n});\r\n  \r\n\r\n// ========================================================================= //\r\n// YOUR ROUTES SHOULD BE DEFINED ABOVE THIS DIVIDER\r\n// ========================================================================= //\r\n\r\n/*\r\n * 404 Not Found Middleware\r\n *\r\n * This should be put at the very end (after all your routes are defined),\r\n * although still above errorHandlers (if any) and app.listen().\r\n */\r\napp.use((req: Request, res: Response) => {\r\n    const error = `\r\n      404 Not found - This could be because:\r\n        0. You have defined routes below (not above) this middleware in server.ts\r\n        1. You have not implemented the route ${req.method} ${req.path}\r\n        2. There is a typo in either your test or server, e.g. /posts/list in one\r\n           and, incorrectly, /post/list in the other\r\n        3. You are using ts-node (instead of ts-node-dev) to start your server and\r\n           have forgotten to manually restart to load the new changes\r\n        4. You've forgotten a leading slash (/), e.g. you have posts/list instead\r\n           of /posts/list in your server.ts or test file\r\n    `;\r\n    res.status(404).json({ error });\r\n  });\r\n  \r\n// For handling errors\r\napp.use(errorHandler());\r\n\r\n// start server\r\nconst server = app.listen(PORT, HOST, () => {\r\n  // DO NOT CHANGE THIS LINE\r\n  console.log(`⚡️ Server started on port ${PORT} at ${HOST}`);\r\n});\r\n\r\n// For coverage, handle Ctrl+C gracefully\r\nprocess.on('SIGINT', () => {\r\n  server.close(() => console.log('Shutting down server gracefully.'));\r\n});\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e2fb314dbca3b5852425b165896f67ffb9d78d5c","contentHash":"ec3c69e673201f758ee81ba1f193b93e0c46b8fdcdf689fd641d68f4ad1d7e20"},"C:\\FAIZ\\UNIV\\Gabut v2.0\\forum\\src\\other.ts":{"path":"C:\\FAIZ\\UNIV\\Gabut v2.0\\forum\\src\\other.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":23}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":42}},"3":{"start":{"line":5,"column":14},"end":{"line":13,"column":1}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":43}},"5":{"start":{"line":7,"column":4},"end":{"line":7,"column":26}},"6":{"start":{"line":8,"column":4},"end":{"line":8,"column":27}},"7":{"start":{"line":9,"column":4},"end":{"line":9,"column":27}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":29}},"9":{"start":{"line":11,"column":4},"end":{"line":11,"column":35}},"10":{"start":{"line":12,"column":4},"end":{"line":12,"column":14}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":22}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":14},"end":{"line":5,"column":15}},"loc":{"start":{"line":5,"column":20},"end":{"line":13,"column":1}},"line":5}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":16,"5":16,"6":16,"7":16,"8":16,"9":16,"10":16,"11":1},"f":{"0":16},"b":{},"inputSourceMap":{"version":3,"file":"C:/FAIZ/UNIV/Gabut v2.0/forum/src/other.ts","sources":["C:/FAIZ/UNIV/Gabut v2.0/forum/src/other.ts"],"names":[],"mappings":";;;AAAA,2CAA2D;AAEpD,MAAM,KAAK,GAAG,GAAgB,EAAE;IACnC,MAAM,IAAI,GAAG,IAAA,mBAAO,GAAE,CAAC;IACvB,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;IACtB,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;IACvB,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;IACvB,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;IACzB,IAAA,mBAAO,EAAC,IAAI,CAAC,CAAC;IACd,OAAO,EAAE,CAAC;AACd,CAAC,CAAA;AARY,QAAA,KAAK,SAQjB","sourcesContent":["import { getData, setData, EmptyObject } from './dataStore'\r\n\r\nexport const clear = (): EmptyObject => {\r\n    const data = getData();\r\n    data.users.length = 0;\r\n    data.tokens.length = 0;\r\n    data.topics.length = 0;\r\n    data.messages.length = 0;\r\n    setData(data);\r\n    return {};\r\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ce0fb689a53a09e030861d2e9c745d2db1c27fb9","contentHash":"51e780e67887b3b222a4be533cc65abf23020926e132ee44a5e33887ce28b734"},"C:\\FAIZ\\UNIV\\Gabut v2.0\\forum\\src\\dataStore.ts":{"path":"C:\\FAIZ\\UNIV\\Gabut v2.0\\forum\\src\\dataStore.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":128}},"4":{"start":{"line":7,"column":13},"end":{"line":7,"column":43}},"5":{"start":{"line":8,"column":17},"end":{"line":8,"column":51}},"6":{"start":{"line":9,"column":20},"end":{"line":9,"column":48}},"7":{"start":{"line":10,"column":16},"end":{"line":12,"column":1}},"8":{"start":{"line":11,"column":4},"end":{"line":11,"column":95}},"9":{"start":{"line":13,"column":0},"end":{"line":13,"column":26}},"10":{"start":{"line":14,"column":19},"end":{"line":16,"column":1}},"11":{"start":{"line":15,"column":4},"end":{"line":15,"column":49}},"12":{"start":{"line":17,"column":0},"end":{"line":17,"column":32}},"13":{"start":{"line":18,"column":0},"end":{"line":18,"column":47}},"14":{"start":{"line":19,"column":23},"end":{"line":28,"column":1}},"15":{"start":{"line":20,"column":17},"end":{"line":22,"column":22}},"16":{"start":{"line":24,"column":22},"end":{"line":24,"column":52}},"17":{"start":{"line":26,"column":22},"end":{"line":26,"column":73}},"18":{"start":{"line":27,"column":4},"end":{"line":27,"column":21}},"19":{"start":{"line":29,"column":0},"end":{"line":29,"column":40}},"20":{"start":{"line":30,"column":11},"end":{"line":35,"column":1}},"21":{"start":{"line":36,"column":13},"end":{"line":38,"column":1}},"22":{"start":{"line":37,"column":4},"end":{"line":37,"column":81}},"23":{"start":{"line":39,"column":16},"end":{"line":45,"column":1}},"24":{"start":{"line":40,"column":4},"end":{"line":43,"column":5}},"25":{"start":{"line":41,"column":21},"end":{"line":41,"column":87}},"26":{"start":{"line":42,"column":8},"end":{"line":42,"column":32}},"27":{"start":{"line":44,"column":4},"end":{"line":44,"column":16}},"28":{"start":{"line":46,"column":0},"end":{"line":46,"column":26}},"29":{"start":{"line":48,"column":16},"end":{"line":51,"column":1}},"30":{"start":{"line":49,"column":4},"end":{"line":49,"column":19}},"31":{"start":{"line":50,"column":4},"end":{"line":50,"column":11}},"32":{"start":{"line":52,"column":0},"end":{"line":52,"column":26}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":10,"column":16},"end":{"line":10,"column":17}},"loc":{"start":{"line":10,"column":31},"end":{"line":12,"column":1}},"line":10},"2":{"name":"(anonymous_2)","decl":{"start":{"line":14,"column":19},"end":{"line":14,"column":20}},"loc":{"start":{"line":14,"column":25},"end":{"line":16,"column":1}},"line":14},"3":{"name":"(anonymous_3)","decl":{"start":{"line":19,"column":23},"end":{"line":19,"column":24}},"loc":{"start":{"line":19,"column":74},"end":{"line":28,"column":1}},"line":19},"4":{"name":"(anonymous_4)","decl":{"start":{"line":36,"column":13},"end":{"line":36,"column":14}},"loc":{"start":{"line":36,"column":19},"end":{"line":38,"column":1}},"line":36},"5":{"name":"(anonymous_5)","decl":{"start":{"line":39,"column":16},"end":{"line":39,"column":17}},"loc":{"start":{"line":39,"column":22},"end":{"line":45,"column":1}},"line":39},"6":{"name":"(anonymous_6)","decl":{"start":{"line":48,"column":16},"end":{"line":48,"column":17}},"loc":{"start":{"line":48,"column":29},"end":{"line":51,"column":1}},"line":48}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":69}},"type":"default-arg","locations":[{"start":{"line":19,"column":59},"end":{"line":19,"column":69}}],"line":19},"4":{"loc":{"start":{"line":40,"column":4},"end":{"line":43,"column":5}},"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":43,"column":5}},{"start":{"line":40,"column":4},"end":{"line":43,"column":5}}],"line":40}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":22,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":36,"16":36,"17":36,"18":36,"19":1,"20":1,"21":1,"22":41,"23":1,"24":60,"25":60,"26":60,"27":60,"28":1,"29":1,"30":41,"31":41,"32":1},"f":{"0":2,"1":22,"2":1,"3":36,"4":41,"5":60,"6":41},"b":{"0":[1,1,1],"1":[0,2],"2":[2,2],"3":[36],"4":[60,0]},"inputSourceMap":{"version":3,"file":"C:/FAIZ/UNIV/Gabut v2.0/forum/src/dataStore.ts","sources":["C:/FAIZ/UNIV/Gabut v2.0/forum/src/dataStore.ts"],"names":[],"mappings":";;;;;;AAAA,4CAAoB;AACpB,oDAA4B;AAG5B,MAAM,WAAW,GAAG,4BAA4B,CAAC;AAE1C,MAAM,OAAO,GAAG,CAAC,SAAiB,EAAE,EAAE;IAC3C,OAAO,gBAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,SAAS,GAAG,WAAW,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AACnF,CAAC,CAAC;AAFW,QAAA,OAAO,WAElB;AAEK,MAAM,UAAU,GAAG,GAAG,EAAE;IAC7B,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AAC/C,CAAC,CAAC;AAFW,QAAA,UAAU,cAErB;AAEW,QAAA,UAAU,GAAG,IAAA,kBAAU,GAAE,CAAC;AAEhC,MAAM,cAAc,GAAG,CAAC,YAAoB,EAAE,WAAmB,EAAE,KAAK,GAAG,UAAU,EAAE,EAAE;IAC9F,MAAM,IAAI,GAAG,gBAAM,CAAC,UAAU,CAAC,QAAQ,CAAC;SACrC,MAAM,CAAC,MAAM,CAAC,YAAY,GAAG,WAAW,CAAC,GAAG,WAAW,GAAG,kBAAU,CAAC;SACrE,MAAM,CAAC,KAAK,CAAC,CAAC;IAEjB,iEAAiE;IACjE,MAAM,SAAS,GAAG,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IAEjD,8CAA8C;IAC9C,MAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,SAAS,GAAG,CAAC,SAAA,CAAC,EAAI,EAAE,CAAA,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC;IAE9D,OAAO,SAAS,CAAC;AACnB,CAAC,CAAC;AAZW,QAAA,cAAc,kBAYzB;AAkCF,IAAI,IAAI,GAAc;IAClB,KAAK,EAAE,EAAE;IACT,MAAM,EAAE,EAAE;IACV,MAAM,EAAE,EAAE;IACV,QAAQ,EAAE,EAAE;CACf,CAAC;AAEF,MAAM,IAAI,GAAG,GAAG,EAAE;IACd,YAAE,CAAC,aAAa,CAAC,iBAAiB,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;AACvE,CAAC,CAAC;AAEK,MAAM,OAAO,GAAG,GAAc,EAAE;IACnC,IAAI,YAAE,CAAC,UAAU,CAAC,iBAAiB,CAAC,EAAE,CAAC;QACrC,MAAM,IAAI,GAAG,YAAE,CAAC,YAAY,CAAC,iBAAiB,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,CAAC;QACtE,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IAC1B,CAAC;IACD,OAAO,IAAI,CAAC;AAChB,CAAC,CAAC;AANW,QAAA,OAAO,WAMlB;AAEA,8EAA8E;AACvE,MAAM,OAAO,GAAG,CAAC,OAAkB,EAAQ,EAAE;IAClD,IAAI,GAAG,OAAO,CAAC;IACf,IAAI,EAAE,CAAC;AACX,CAAC,CAAC;AAHa,QAAA,OAAO,WAGpB","sourcesContent":["import fs from 'fs';\r\nimport crypto from 'crypto';\r\nexport type EmptyObject = Record<never, never>;\r\n\r\nconst SECRET_TEXT = 'JanganTinggalkanAkuSendiri';\r\n\r\nexport const getHash = (plainText: string) => {\r\n  return crypto.createHash('sha256').update(plainText + SECRET_TEXT).digest('hex');\r\n};\r\n\r\nexport const randomizer = () => {\r\n  return Math.floor(Math.random() * (100)) + 1;\r\n};\r\n\r\nexport const SECRET_INT = randomizer();\r\n\r\nexport const getHashInteger = (integerValue: number, multipliers: number, range = 1000000000) => {\r\n  const hash = crypto.createHash('sha256')\r\n    .update(String(integerValue * multipliers) + SECRET_TEXT + SECRET_INT)\r\n    .digest('hex');\r\n\r\n  // Use the first 8 characters (4 bytes) of the hash as an integer\r\n  const hashedInt = parseInt(hash.slice(0, 8), 16);\r\n\r\n  // Map the hashed integer to the desired range\r\n  const mappedInt = Math.floor((hashedInt / (2 ** 32)) * range);\r\n\r\n  return mappedInt;\r\n};\r\n\r\nexport interface Users {\r\n    username: string;\r\n    displayName: string;\r\n    password: string;\r\n}\r\n\r\nexport interface Tokens {\r\n    token: number;\r\n    username: string;\r\n}\r\n\r\nexport interface Topics {\r\n    topicId: number;\r\n    title: string;\r\n    description: string;\r\n    pin: boolean;\r\n}\r\n\r\nexport interface Messages {\r\n    messageId: number;\r\n    topicId: number;\r\n    sender: number;\r\n    timeSent: number;\r\n}\r\n\r\nexport interface DataStore {\r\n    users: Users[];\r\n    tokens: Tokens[];\r\n    topics: Topics[];\r\n    messages: Messages[];\r\n}\r\n\r\nlet data: DataStore = {\r\n    users: [],\r\n    tokens: [],\r\n    topics: [],\r\n    messages: []\r\n};\r\n\r\nconst save = () => {\r\n    fs.writeFileSync('./database.json', JSON.stringify(data, null, 2));\r\n};\r\n\r\nexport const getData = (): DataStore => {\r\n    if (fs.existsSync('./database.json')) {\r\n      const json = fs.readFileSync('./database.json', { encoding: 'utf8' });\r\n      data = JSON.parse(json);\r\n    }\r\n    return data;\r\n};\r\n  \r\n  // Use set(newData) to pass in the entire data object, with modifications made\r\n  export const setData = (newData: DataStore): void => {\r\n    data = newData;\r\n    save();\r\n};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c77b8d49858827bbd2fa20e2079d9f7e09dcbe3e","contentHash":"b48bd8878dd946d68647a53abf82538816c892fa1e63908a21f0ad57e3e0f748"},"C:\\FAIZ\\UNIV\\Gabut v2.0\\forum\\src\\auth.ts":{"path":"C:\\FAIZ\\UNIV\\Gabut v2.0\\forum\\src\\auth.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":104}},"4":{"start":{"line":7,"column":20},"end":{"line":7,"column":42}},"5":{"start":{"line":8,"column":22},"end":{"line":8,"column":61}},"6":{"start":{"line":9,"column":19},"end":{"line":16,"column":1}},"7":{"start":{"line":10,"column":17},"end":{"line":10,"column":43}},"8":{"start":{"line":11,"column":17},"end":{"line":11,"column":69}},"9":{"start":{"line":11,"column":39},"end":{"line":11,"column":68}},"10":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"11":{"start":{"line":13,"column":8},"end":{"line":13,"column":63}},"12":{"start":{"line":15,"column":4},"end":{"line":15,"column":39}},"13":{"start":{"line":17,"column":0},"end":{"line":17,"column":32}},"14":{"start":{"line":18,"column":25},"end":{"line":61,"column":1}},"15":{"start":{"line":19,"column":17},"end":{"line":19,"column":43}},"16":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"17":{"start":{"line":21,"column":8},"end":{"line":21,"column":90}},"18":{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},"19":{"start":{"line":24,"column":8},"end":{"line":24,"column":110}},"20":{"start":{"line":27,"column":4},"end":{"line":29,"column":5}},"21":{"start":{"line":27,"column":29},"end":{"line":27,"column":52}},"22":{"start":{"line":28,"column":8},"end":{"line":28,"column":72}},"23":{"start":{"line":30,"column":4},"end":{"line":32,"column":5}},"24":{"start":{"line":31,"column":8},"end":{"line":31,"column":73}},"25":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"26":{"start":{"line":34,"column":8},"end":{"line":34,"column":71}},"27":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"28":{"start":{"line":37,"column":8},"end":{"line":37,"column":119}},"29":{"start":{"line":39,"column":19},"end":{"line":39,"column":72}},"30":{"start":{"line":40,"column":19},"end":{"line":40,"column":21}},"31":{"start":{"line":41,"column":4},"end":{"line":46,"column":5}},"32":{"start":{"line":42,"column":8},"end":{"line":42,"column":21}},"33":{"start":{"line":45,"column":8},"end":{"line":45,"column":65}},"34":{"start":{"line":47,"column":18},"end":{"line":47,"column":62}},"35":{"start":{"line":48,"column":4},"end":{"line":52,"column":7}},"36":{"start":{"line":53,"column":4},"end":{"line":56,"column":7}},"37":{"start":{"line":57,"column":4},"end":{"line":57,"column":35}},"38":{"start":{"line":58,"column":4},"end":{"line":60,"column":6}},"39":{"start":{"line":62,"column":0},"end":{"line":62,"column":44}},"40":{"start":{"line":63,"column":22},"end":{"line":88,"column":1}},"41":{"start":{"line":64,"column":17},"end":{"line":64,"column":43}},"42":{"start":{"line":65,"column":17},"end":{"line":65,"column":115}},"43":{"start":{"line":65,"column":38},"end":{"line":65,"column":114}},"44":{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},"45":{"start":{"line":67,"column":8},"end":{"line":67,"column":80}},"46":{"start":{"line":69,"column":4},"end":{"line":71,"column":5}},"47":{"start":{"line":69,"column":30},"end":{"line":69,"column":53}},"48":{"start":{"line":70,"column":8},"end":{"line":70,"column":67}},"49":{"start":{"line":72,"column":19},"end":{"line":72,"column":21}},"50":{"start":{"line":73,"column":4},"end":{"line":78,"column":5}},"51":{"start":{"line":74,"column":8},"end":{"line":74,"column":21}},"52":{"start":{"line":77,"column":8},"end":{"line":77,"column":65}},"53":{"start":{"line":79,"column":18},"end":{"line":79,"column":62}},"54":{"start":{"line":80,"column":4},"end":{"line":83,"column":7}},"55":{"start":{"line":84,"column":4},"end":{"line":84,"column":35}},"56":{"start":{"line":85,"column":4},"end":{"line":87,"column":6}},"57":{"start":{"line":89,"column":0},"end":{"line":89,"column":38}},"58":{"start":{"line":90,"column":23},"end":{"line":96,"column":1}},"59":{"start":{"line":91,"column":17},"end":{"line":91,"column":43}},"60":{"start":{"line":92,"column":4},"end":{"line":92,"column":35}},"61":{"start":{"line":93,"column":4},"end":{"line":93,"column":73}},"62":{"start":{"line":93,"column":42},"end":{"line":93,"column":71}},"63":{"start":{"line":94,"column":4},"end":{"line":94,"column":35}},"64":{"start":{"line":95,"column":4},"end":{"line":95,"column":14}},"65":{"start":{"line":97,"column":0},"end":{"line":97,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":19},"end":{"line":9,"column":20}},"loc":{"start":{"line":9,"column":30},"end":{"line":16,"column":1}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":34},"end":{"line":11,"column":35}},"loc":{"start":{"line":11,"column":39},"end":{"line":11,"column":68}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":18,"column":25},"end":{"line":18,"column":26}},"loc":{"start":{"line":18,"column":78},"end":{"line":61,"column":1}},"line":18},"4":{"name":"(anonymous_4)","decl":{"start":{"line":27,"column":24},"end":{"line":27,"column":25}},"loc":{"start":{"line":27,"column":29},"end":{"line":27,"column":52}},"line":27},"5":{"name":"(anonymous_5)","decl":{"start":{"line":63,"column":22},"end":{"line":63,"column":23}},"loc":{"start":{"line":63,"column":46},"end":{"line":88,"column":1}},"line":63},"6":{"name":"(anonymous_6)","decl":{"start":{"line":65,"column":33},"end":{"line":65,"column":34}},"loc":{"start":{"line":65,"column":38},"end":{"line":65,"column":114}},"line":65},"7":{"name":"(anonymous_7)","decl":{"start":{"line":69,"column":25},"end":{"line":69,"column":26}},"loc":{"start":{"line":69,"column":30},"end":{"line":69,"column":53}},"line":69},"8":{"name":"(anonymous_8)","decl":{"start":{"line":90,"column":23},"end":{"line":90,"column":24}},"loc":{"start":{"line":90,"column":34},"end":{"line":96,"column":1}},"line":90},"9":{"name":"(anonymous_9)","decl":{"start":{"line":93,"column":37},"end":{"line":93,"column":38}},"loc":{"start":{"line":93,"column":42},"end":{"line":93,"column":71}},"line":93}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},{"start":{"line":12,"column":4},"end":{"line":14,"column":5}}],"line":12},"4":{"loc":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},{"start":{"line":20,"column":4},"end":{"line":22,"column":5}}],"line":20},"5":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":57}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":29}},{"start":{"line":20,"column":33},"end":{"line":20,"column":57}}],"line":20},"6":{"loc":{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},{"start":{"line":23,"column":4},"end":{"line":25,"column":5}}],"line":23},"7":{"loc":{"start":{"line":27,"column":4},"end":{"line":29,"column":5}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":29,"column":5}},{"start":{"line":27,"column":4},"end":{"line":29,"column":5}}],"line":27},"8":{"loc":{"start":{"line":30,"column":4},"end":{"line":32,"column":5}},"type":"if","locations":[{"start":{"line":30,"column":4},"end":{"line":32,"column":5}},{"start":{"line":30,"column":4},"end":{"line":32,"column":5}}],"line":30},"9":{"loc":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},{"start":{"line":33,"column":4},"end":{"line":35,"column":5}}],"line":33},"10":{"loc":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},{"start":{"line":36,"column":4},"end":{"line":38,"column":5}}],"line":36},"11":{"loc":{"start":{"line":41,"column":4},"end":{"line":46,"column":5}},"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":46,"column":5}},{"start":{"line":41,"column":4},"end":{"line":46,"column":5}}],"line":41},"12":{"loc":{"start":{"line":65,"column":38},"end":{"line":65,"column":114}},"type":"binary-expr","locations":[{"start":{"line":65,"column":38},"end":{"line":65,"column":61}},{"start":{"line":65,"column":65},"end":{"line":65,"column":114}}],"line":65},"13":{"loc":{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},{"start":{"line":66,"column":4},"end":{"line":68,"column":5}}],"line":66},"14":{"loc":{"start":{"line":69,"column":4},"end":{"line":71,"column":5}},"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":71,"column":5}},{"start":{"line":69,"column":4},"end":{"line":71,"column":5}}],"line":69},"15":{"loc":{"start":{"line":73,"column":4},"end":{"line":78,"column":5}},"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":78,"column":5}},{"start":{"line":73,"column":4},"end":{"line":78,"column":5}}],"line":73}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":6,"8":6,"9":7,"10":6,"11":1,"12":5,"13":1,"14":1,"15":25,"16":25,"17":0,"18":25,"19":9,"20":16,"21":1,"22":0,"23":16,"24":0,"25":16,"26":0,"27":16,"28":0,"29":16,"30":16,"31":16,"32":15,"33":1,"34":16,"35":16,"36":16,"37":16,"38":16,"39":1,"40":1,"41":7,"42":7,"43":8,"44":7,"45":2,"46":5,"47":2,"48":1,"49":4,"50":4,"51":3,"52":1,"53":4,"54":4,"55":4,"56":4,"57":1,"58":1,"59":6,"60":6,"61":5,"62":6,"63":5,"64":5,"65":1},"f":{"0":1,"1":6,"2":7,"3":25,"4":1,"5":7,"6":8,"7":2,"8":6,"9":6},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[1,5],"4":[0,25],"5":[25,25],"6":[9,16],"7":[0,16],"8":[0,16],"9":[0,16],"10":[0,16],"11":[15,1],"12":[8,6],"13":[2,5],"14":[1,4],"15":[3,1]},"inputSourceMap":{"version":3,"file":"C:/FAIZ/UNIV/Gabut v2.0/forum/src/auth.ts","sources":["C:/FAIZ/UNIV/Gabut v2.0/forum/src/auth.ts"],"names":[],"mappings":"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","sourcesContent":["import { getData, setData, getHash, getHashInteger, EmptyObject } from './dataStore';\r\nimport HTTPError from 'http-errors';\r\n\r\nexport interface Token {\r\n    token: string\r\n}\r\n\r\nexport interface Username {\r\n    username: string\r\n}\r\n\r\nexport const loggedinId = (token: string): Username => {\r\n    const data = getData();\r\n\r\n    const user = data.tokens.find(u => u.token === JSON.parse(token));\r\n    if (!user) {\r\n        throw HTTPError(401, \"Invalid token\");\r\n    }\r\n\r\n    return { username: user.username };\r\n}\r\n\r\nexport const userAuthRegister = (username: string, displayName: string, password: string, repeatPassword: string): Token => {\r\n    const data = getData();\r\n    \r\n    if (username.length === 0 || displayName.length === 0) {\r\n        throw HTTPError(400, \"Username and displayName cannot be empty\");\r\n    }\r\n\r\n    if (!/^[a-z0-9]+$/.test(username)) {\r\n        throw HTTPError(400, \"Username can only contains lowercase alphanumeric characters\");\r\n    };\r\n\r\n    if (data.users.some(u => u.username === username)) {\r\n        throw HTTPError(400, \"Username has been used\")\r\n    }\r\n\r\n    if (password !== repeatPassword) {\r\n        throw HTTPError(400, \"Password does not match\");\r\n    }\r\n\r\n    if (password.length < 8) {\r\n        throw HTTPError(400, \"Password is too short\");\r\n    }\r\n\r\n    if (!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d).+$/.test(password)) {\r\n        throw HTTPError(400, \"Password must contain at least 1 number, 1 lowercase, and 1 uppercase\");\r\n    }\r\n\r\n    const userId = getHashInteger(data.users.length, 2);\r\n\r\n    let newToken = -1;\r\n    if (data.tokens.length === 0) {\r\n      newToken = 0;\r\n    } else {\r\n      newToken = data.tokens[data.tokens.length - 1].token + 1;\r\n    }\r\n\r\n    const token = getHashInteger(newToken, 4);\r\n\r\n    data.users.push({\r\n        username,\r\n        displayName,\r\n        password: getHash(password)\r\n    })\r\n\r\n    data.tokens.push({\r\n        username,\r\n        token\r\n    })\r\n\r\n    setData(data);\r\n    return {\r\n        token: JSON.stringify(token)\r\n    }\r\n}\r\n\r\nexport const userAuthLogin = (username: string, password: string): Token => {\r\n    const data = getData();\r\n\r\n    const user = data.users.find(u => u.username === username && u.password === getHash(password));\r\n    if (!user) {\r\n        throw HTTPError(400, \"incorrect username or password\");\r\n    }\r\n\r\n    if (data.tokens.some(t => t.username === username)) {\r\n        throw HTTPError(400, \"Already logged in\");\r\n    }\r\n\r\n    let newToken = -1;\r\n    if (data.tokens.length === 0) {\r\n      newToken = 0;\r\n    } else {\r\n      newToken = data.tokens[data.tokens.length - 1].token + 1;\r\n    }\r\n\r\n    const token = getHashInteger(newToken, 4);\r\n    data.tokens.push({\r\n        username,\r\n        token\r\n    })\r\n\r\n    setData(data);\r\n    return {\r\n        token: JSON.stringify(token)\r\n    }\r\n}\r\n\r\nexport const userAuthLogout = (token: string): EmptyObject => {\r\n    const data = getData();\r\n    loggedinId(token);\r\n\r\n    data.tokens = data.tokens.filter(t => t.token !== JSON.parse(token));\r\n    setData(data);\r\n    return {};\r\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d2671b0adbbd6a44c65234c7dee4fdd7ab6a6c7b","contentHash":"6cf5e81660e560e6a1dfe19e645364064206f77cc41fa1a48805016fc337a0fc"}}